---
title: Migrar os scripts do Azure PowerShell do AzureRM para o Az
description: Conheça as etapas e as ferramentas para migrar os scripts do Azure PowerShell do AzureRM para o novo módulo Az PowerShell.
ms.devlang: powershell
ms.service: azure-powershell
ms.topic: conceptual
ms.date: 12/15/2020
ms.custom: devx-track-azurepowershell, contperf-fy21q2
ms.openlocfilehash: 6bccaf9a628f67b8945516bae70f07939cdce8f7
ms.sourcegitcommit: 4dfb0cc533b83f77afdcfbe2618c1e6c8d221330
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 03/04/2021
ms.locfileid: "101872230"
---
# <a name="migrate-azure-powershell-from-azurerm-to-az"></a><span data-ttu-id="45347-103">Migrar o Azure PowerShell do AzureRM para o Az</span><span class="sxs-lookup"><span data-stu-id="45347-103">Migrate Azure PowerShell from AzureRM to Az</span></span>

<span data-ttu-id="45347-104">Todas as versões do módulo AzureRM PowerShell estão desatualizadas.</span><span class="sxs-lookup"><span data-stu-id="45347-104">All versions of the AzureRM PowerShell module are outdated.</span></span> <span data-ttu-id="45347-105">Agora, o [módulo Az PowerShell](install-az-ps.md) é o módulo do PowerShell recomendado para interagir com o Azure.</span><span class="sxs-lookup"><span data-stu-id="45347-105">The [Az PowerShell module](install-az-ps.md) is now the recommended PowerShell module for interacting with Azure.</span></span>

## <a name="why-a-new-module"></a><span data-ttu-id="45347-106">Por que um novo módulo?</span><span class="sxs-lookup"><span data-stu-id="45347-106">Why a new module?</span></span>

<span data-ttu-id="45347-107">A maior e mais importante alteração é que o [PowerShell](/powershell/scripting/overview), baseado na biblioteca .NET Standard, tem sido um produto multiplataforma desde que foi introduzido.</span><span class="sxs-lookup"><span data-stu-id="45347-107">The biggest and most important change is that [PowerShell](/powershell/scripting/overview), being based on the .NET Standard library, has been a cross-platform product since its introduction.</span></span>

<span data-ttu-id="45347-108">Como a linguagem do PowerShell, estamos comprometidos em oferecer o suporte do Azure em todas as plataformas.</span><span class="sxs-lookup"><span data-stu-id="45347-108">Like the PowerShell language, we're committed to bringing Azure support to all platforms.</span></span> <span data-ttu-id="45347-109">Nosso compromisso significava que os módulos do Azure PowerShell precisavam ser atualizados para usar o .NET Standard e ser compatíveis com o PowerShell Core.</span><span class="sxs-lookup"><span data-stu-id="45347-109">Our commitment meant that the Azure PowerShell modules needed to be updated to use .NET Standard and be compatible with PowerShell Core.</span></span> <span data-ttu-id="45347-110">Em vez de modificar o módulo AzureRM existente e introduzir alterações complexas para adicionar esse suporte, o módulo Az foi criado.</span><span class="sxs-lookup"><span data-stu-id="45347-110">Rather than modifying the existing AzureRM module and introducing complex changes to add this support, the Az module was created.</span></span>

<span data-ttu-id="45347-111">A criação de um módulo também permitiu que nossos engenheiros tornassem consistentes o design e a nomeação de cmdlets e módulos.</span><span class="sxs-lookup"><span data-stu-id="45347-111">Creating a new module also allowed our engineers to make the design, naming of cmdlets, and modules consistent.</span></span> <span data-ttu-id="45347-112">Todos os módulos agora começam com o prefixo `Az.` e todos os cmdlets usam a convenção de nomenclatura `Verb-AzNoun`.</span><span class="sxs-lookup"><span data-stu-id="45347-112">All modules now start with the `Az.` prefix and cmdlets all use the `Verb-AzNoun` naming convention.</span></span> <span data-ttu-id="45347-113">Anteriormente, os nomes dos cmdlets eram mais longos e inconsistentes.</span><span class="sxs-lookup"><span data-stu-id="45347-113">Previously, cmdlet names were longer and inconsistent.</span></span>

<span data-ttu-id="45347-114">O número de módulos também foi reduzido: Alguns módulos que funcionavam com os mesmos serviços foram combinados.</span><span class="sxs-lookup"><span data-stu-id="45347-114">The number of modules were also reduced: Some modules that worked with the same services have been combined.</span></span> <span data-ttu-id="45347-115">Os cmdlets do plano de gerenciamento e do plano de dados agora estão contidos em módulo único.</span><span class="sxs-lookup"><span data-stu-id="45347-115">Management plane and data plane cmdlets for the same service are now contained within a single module.</span></span> <span data-ttu-id="45347-116">Para aqueles que gerenciam dependências e importações manualmente, essa consolidação simplifica muito as coisas.</span><span class="sxs-lookup"><span data-stu-id="45347-116">For those of you who manually manage dependencies and imports, this consolidation makes things much simpler.</span></span>

<span data-ttu-id="45347-117">Ao fazer essas alterações importantes, a equipe se comprometeu em tornar o uso do Azure com cmdlets do PowerShell mais fácil do que nunca e em mais plataformas do que era possível anteriormente.</span><span class="sxs-lookup"><span data-stu-id="45347-117">By making these important changes, the team has committed to making it easier than ever before and on more platforms than previously possible to use Azure with PowerShell cmdlets.</span></span>

## <a name="upgrading-to-az-powershell"></a><span data-ttu-id="45347-118">Atualizando para o Az PowerShell</span><span class="sxs-lookup"><span data-stu-id="45347-118">Upgrading to Az PowerShell</span></span>

<span data-ttu-id="45347-119">Os scripts gravados para os cmdlets do AzureRM não funcionarão automaticamente no Az.</span><span class="sxs-lookup"><span data-stu-id="45347-119">Scripts written for the AzureRM cmdlets won't automatically work with Az.</span></span> <span data-ttu-id="45347-120">Para facilitar a transição, foi desenvolvido o [kit de ferramentas de migração do AzureRM para o Az](https://github.com/Azure/azure-powershell-migration).</span><span class="sxs-lookup"><span data-stu-id="45347-120">To make the transition easier, the [AzureRM to Az migration toolkit](https://github.com/Azure/azure-powershell-migration) was developed.</span></span> <span data-ttu-id="45347-121">Nenhuma migração para um novo conjunto de comandos é conveniente, mas este artigo ajudará você a começar a realizar a transição para o módulo Az do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="45347-121">No migration to a new command set is ever convenient, but this article will help you get started on transitioning to the Az PowerShell module.</span></span> <span data-ttu-id="45347-122">Para saber mais sobre o módulo Az do PowerShell, confira [Introdução do novo módulo Az do Azure PowerShell](new-azureps-module-az.md).</span><span class="sxs-lookup"><span data-stu-id="45347-122">To learn more about why the Az PowerShell module was created, see [Introducing the new Azure PowerShell Az module](new-azureps-module-az.md).</span></span>

<span data-ttu-id="45347-123">Os novos nomes de cmdlets foram projetados para serem fáceis de aprender.</span><span class="sxs-lookup"><span data-stu-id="45347-123">The new cmdlet names have been designed to be easy to learn.</span></span> <span data-ttu-id="45347-124">Em vez de usar `AzureRm` ou `Azure` nos nomes de cmdlets, use `Az`.</span><span class="sxs-lookup"><span data-stu-id="45347-124">Instead of using `AzureRm` or `Azure` in cmdlet names, use `Az`.</span></span> <span data-ttu-id="45347-125">Por exemplo, o cmdlet antigo `New-AzureRMVm` tornou-se `New-AzVm`.</span><span class="sxs-lookup"><span data-stu-id="45347-125">For example, the old cmdlet `New-AzureRMVm` has become `New-AzVm`.</span></span>
<span data-ttu-id="45347-126">Contudo, a migração é mais do que apenas se familiarizar com os novos nomes de cmdlets.</span><span class="sxs-lookup"><span data-stu-id="45347-126">However, migration is more than just becoming familiar with the new cmdlet names, though.</span></span> <span data-ttu-id="45347-127">Há módulos e parâmetros renomeados, além de outras alterações importantes.</span><span class="sxs-lookup"><span data-stu-id="45347-127">There are renamed modules, parameters, and other important changes.</span></span>

<span data-ttu-id="45347-128">Para ver a lista completa de alterações da falha entre o AzureRM e o Az, confira as [alterações completas do AzureRM para o Az](migrate-az-1.0.0.md).</span><span class="sxs-lookup"><span data-stu-id="45347-128">To see the full list of breaking changes between AzureRM and Az, see the [full changes from AzureRM to Az](migrate-az-1.0.0.md).</span></span>

## <a name="ensure-existing-scripts-work-with-the-latest-azurerm-release"></a><span data-ttu-id="45347-129">Verifique se os scripts existentes funcionam com a última versão do AzureRM</span><span class="sxs-lookup"><span data-stu-id="45347-129">Ensure existing scripts work with the latest AzureRM release</span></span>

<span data-ttu-id="45347-130">Antes de executar qualquer etapa de migração, verifique quais versões do AzureRM estão instaladas em seu sistema.</span><span class="sxs-lookup"><span data-stu-id="45347-130">Before taking any migration steps, check which versions of AzureRM are installed on your system.</span></span>
<span data-ttu-id="45347-131">Esse procedimento permite que você verifique se os scripts já estão em execução na última versão e se você sabe quais versões do AzureRM precisam ser desinstaladas.</span><span class="sxs-lookup"><span data-stu-id="45347-131">Doing so allows you to make sure scripts are already running on the latest release and let you know which versions of AzureRM must be uninstalled.</span></span>

<span data-ttu-id="45347-132">Para verificar qual versão do AzureRM você instalou, execute o seguinte exemplo:</span><span class="sxs-lookup"><span data-stu-id="45347-132">To check which version(s) of AzureRM you have installed, run the following example:</span></span>

```azurepowershell
Get-Module -Name AzureRM -ListAvailable -All
```

<span data-ttu-id="45347-133">A **última** versão disponível do AzureRM é a **6.13.1**.</span><span class="sxs-lookup"><span data-stu-id="45347-133">The **latest** available release of AzureRM is **6.13.1**.</span></span> <span data-ttu-id="45347-134">Se você não tiver essa versão instalada, os scripts existentes poderão precisar de modificação adicional para funcionar com o módulo Az, além do escopo descrito neste artigo e na [lista de alterações da falha](migrate-az-1.0.0.md).</span><span class="sxs-lookup"><span data-stu-id="45347-134">If you don't have this version installed, your existing scripts may need additional modifications to work with the Az module beyond the scope of what's described in this article and in the [breaking changes list](migrate-az-1.0.0.md).</span></span>

<span data-ttu-id="45347-135">Se os scripts não funcionarem com o AzureRM 6.13.1, atualize-os de acordo com o [guia de migração do AzureRM 5.x para o 6.x](/powershell/azure/azurerm/migration-guide.6.0.0).</span><span class="sxs-lookup"><span data-stu-id="45347-135">If your scripts don't work with AzureRM 6.13.1, update them according to the [AzureRM 5.x to 6.x migration guide](/powershell/azure/azurerm/migration-guide.6.0.0).</span></span> <span data-ttu-id="45347-136">Se você usar uma versão anterior do módulo AzureRM, haverá guias de migração disponíveis para cada versão principal.</span><span class="sxs-lookup"><span data-stu-id="45347-136">If you use an earlier version of the AzureRM module, there are migration guides available for each major version.</span></span>

## <a name="option-1-recommended-automatically-migrate-your-powershell-scripts"></a><span data-ttu-id="45347-137">Opção 1 (recomendada): Migrar automaticamente os scripts do PowerShell</span><span class="sxs-lookup"><span data-stu-id="45347-137">Option 1 (recommended): Automatically migrate your PowerShell scripts</span></span>

<span data-ttu-id="45347-138">Essa opção recomendada minimiza o esforço necessário para migrar scripts do AzureRM para o Az.</span><span class="sxs-lookup"><span data-stu-id="45347-138">This recommended option minimizes the effort required to migrate AzureRM scripts to Az.</span></span>

### <a name="install-the-azurerm-to-az-migration-toolkit"></a><span data-ttu-id="45347-139">Instalar o kit de ferramentas de migração do AzureRM para o Az</span><span class="sxs-lookup"><span data-stu-id="45347-139">Install the AzureRM to Az migration toolkit</span></span>

```azurepowershell
Install-Module -Name Az.Tools.Migration
```

### <a name="convert-your-scripts-automatically"></a><span data-ttu-id="45347-140">Converter scripts automaticamente</span><span class="sxs-lookup"><span data-stu-id="45347-140">Convert your scripts automatically</span></span>

<span data-ttu-id="45347-141">Com o kit de ferramentas de migração do AzureRM para o Az, você poderá gerar um plano para determinar quais alterações serão executadas nos scripts antes de fazer qualquer modificação neles e antes de instalar o módulo Az do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="45347-141">With the AzureRM to Az migration toolkit, you can generate a plan to determine what changes will be performed on your scripts before making any modifications to them and before installing the Az PowerShell module.</span></span>

<span data-ttu-id="45347-142">O início rápido [Migrar automaticamente os scripts do PowerShell do AzureRM para o módulo Az do PowerShell](quickstart-migrate-azurerm-to-az-automatically.md) orienta você ao longo do processo inteiro de atualização automática dos scripts do PowerShell do AzureRM para o módulo Az do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="45347-142">The [Automatically migrate PowerShell scripts from AzureRM to the Az PowerShell module](quickstart-migrate-azurerm-to-az-automatically.md) quickstart walks you through the entire process of automatically updating your PowerShell scripts from AzureRM to the Az PowerShell module.</span></span>

## <a name="option-2-use-compatibility-mode-with-enable-azurermalias"></a><span data-ttu-id="45347-143">Opção 2: Usar o modo de compatibilidade com o cmdlet Enable-AzureRmAlias</span><span class="sxs-lookup"><span data-stu-id="45347-143">Option 2: Use compatibility mode with Enable-AzureRmAlias</span></span>

<span data-ttu-id="45347-144">O módulo Az tem um modo de compatibilidade para ajudá-lo a usar os scripts existentes enquanto você atualiza para a nova sintaxe.</span><span class="sxs-lookup"><span data-stu-id="45347-144">The Az module has a compatibility mode to help you use existing scripts while you update to the new syntax.</span></span> <span data-ttu-id="45347-145">O cmdlet [Enable-AzureRmAlias](/powershell/module/az.accounts/enable-azurermalias) habilita um modo de compatibilidade por meio de aliases.</span><span class="sxs-lookup"><span data-stu-id="45347-145">The [Enable-AzureRmAlias](/powershell/module/az.accounts/enable-azurermalias) cmdlet enables a compatibility mode through aliases.</span></span> <span data-ttu-id="45347-146">Esse modo permite que você use scripts existentes com o mínimo de modificações, ao passo que trabalha no sentido de uma migração completa para o Az.</span><span class="sxs-lookup"><span data-stu-id="45347-146">This mode allows you to use existing scripts with minimal modification while working towards a full migration to Az.</span></span> <span data-ttu-id="45347-147">Por padrão, `Enable-AzureRmAlias` habilita apenas aliases de compatibilidade para a sessão atual do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="45347-147">By default, `Enable-AzureRmAlias` only enables compatibility aliases for the current PowerShell session.</span></span> <span data-ttu-id="45347-148">Use seu parâmetro `Scope` para persistir os aliases de compatibilidade entre as sessões do PowerShell.</span><span class="sxs-lookup"><span data-stu-id="45347-148">Use its `Scope` parameter to persist compatibility aliases across PowerShell sessions.</span></span> <span data-ttu-id="45347-149">Para obter mais informações, confira a [documentação de referência de Enable-AzureRmAlias](/powershell/module/az.accounts/enable-azurermalias).</span><span class="sxs-lookup"><span data-stu-id="45347-149">For more information, see [the Enable-AzureRmAlias reference documentation](/powershell/module/az.accounts/enable-azurermalias).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="45347-150">Embora os nomes dos cmdlets sejam convertidos em alias, ainda poderá haver parâmetros novos (ou renomeados) ou valores retornados alterados para os cmdlets do Az.</span><span class="sxs-lookup"><span data-stu-id="45347-150">Even though the cmdlet names are aliased, there may still be new (or renamed) parameters or changed return values for the Az cmdlets.</span></span> <span data-ttu-id="45347-151">Não espere que a habilitação de aliases cuide da migração para você.</span><span class="sxs-lookup"><span data-stu-id="45347-151">Don't expect enabling aliases to take care of the migration for you!</span></span> <span data-ttu-id="45347-152">Confira a [lista completa de alterações da falha](migrate-az-1.0.0.md) para descobrir quando seus scripts podem exigir atualizações.</span><span class="sxs-lookup"><span data-stu-id="45347-152">See the [full breaking changes list](migrate-az-1.0.0.md) to find where your scripts may require updates.</span></span>

## <a name="option-3-migrate-your-scripts-in-visual-studio-code-with-the-azure-powershell-extension"></a><span data-ttu-id="45347-153">Opção 3: Migrar os scripts do Visual Studio Code com a extensão do Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="45347-153">Option 3: Migrate your scripts in Visual Studio Code with the Azure PowerShell extension</span></span>

### <a name="install-the-azure-powershell-extension-for-visual-studio-code"></a><span data-ttu-id="45347-154">Instalar a extensão do Azure PowerShell para Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="45347-154">Install the Azure PowerShell extension for Visual Studio Code</span></span>

<span data-ttu-id="45347-155">Instalar a [extensão do Azure PowerShell para VSCode](https://marketplace.visualstudio.com/items?itemName=azps-tools.azps-tools)</span><span class="sxs-lookup"><span data-stu-id="45347-155">Install the [Azure PowerShell extension for VSCode](https://marketplace.visualstudio.com/items?itemName=azps-tools.azps-tools)</span></span>

### <a name="convert-your-scripts-manually"></a><span data-ttu-id="45347-156">Converter scripts manualmente</span><span class="sxs-lookup"><span data-stu-id="45347-156">Convert your scripts manually</span></span>

1. <span data-ttu-id="45347-157">Carregar o script do AzureRM no VSCode</span><span class="sxs-lookup"><span data-stu-id="45347-157">Load your AzureRM script in VSCode</span></span>
2. <span data-ttu-id="45347-158">Iniciar a migração abrindo a paleta de comandos `Ctrl+Shift+P` e selecionar `Migrate Azure PowerShell script`</span><span class="sxs-lookup"><span data-stu-id="45347-158">Start the migration by opening the command palette `Ctrl+Shift+P` and select `Migrate Azure PowerShell script`</span></span>
3. <span data-ttu-id="45347-159">Selecionar versão de origem `AzureRM`</span><span class="sxs-lookup"><span data-stu-id="45347-159">Select source version `AzureRM`</span></span>
4. <span data-ttu-id="45347-160">Siga as ações recomendadas para cada comando ou parâmetro sublinhado.</span><span class="sxs-lookup"><span data-stu-id="45347-160">Follow the recommended actions for each underlined command or parameter.</span></span>

## <a name="next-steps"></a><span data-ttu-id="45347-161">Próximas etapas</span><span class="sxs-lookup"><span data-stu-id="45347-161">Next steps</span></span>

* [<span data-ttu-id="45347-162">Desinstalar o AzureRM</span><span class="sxs-lookup"><span data-stu-id="45347-162">Uninstall AzureRM</span></span>](uninstall-az-ps.md#uninstall-the-azurerm-module)
* [<span data-ttu-id="45347-163">Instale o Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="45347-163">Install Azure PowerShell</span></span>](install-az-ps.md)
